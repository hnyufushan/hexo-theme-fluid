---
title: é¡¹ç›®å®æˆ˜é—®é¢˜ç¬”è®°
date: 2024-01-18 13:20:56
permalink: /pages/20009.html
categories: 
  - ç¼–ç¨‹ä¸–ç•Œ
  - Javaå­¦ä¹ ç¬”è®°
tags: 
  - null

description: 
---

é¡¹ç›®å®æˆ˜é—®é¢˜ç¬”è®°

> åœºæ™¯ï¼šåŸºäºSpring Bootä½¿ç”¨Javaè°ƒç”¨httpè¯·æ±‚çš„6ç§æ–¹å¼ã€‚æœåŠ¡ç«¯å‘å¸ƒä¸€ä¸ªPOSTè¯·æ±‚å’Œ2ä¸ªGETè¯·æ±‚ã€‚ä½¿ç”¨6ç§æ–¹å¼å®ç°çš„å®¢æˆ·ç«¯éƒ½è°ƒç”¨æœåŠ¡ç«¯å‘å¸ƒçš„è¿™3ä¸ªæ–¹æ³•ã€‚å¯ä»¥ç›´è§‚æ„Ÿå—å’Œæ¯”å¯¹6ç§httpè¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚
## 1.é¡¹ç›®å®ä½“ç±»å±æ€§ä¸å­˜å…¥æ•°æ®åº“æ’é™¤æ–¹å¼
1. @Transient
   è¯¥æ³¨è§£åªé€‚ç”¨äºhibernateæ¡†æ¶ï¼Œåœ¨å®ä½“ç±»ï¼ˆpojoï¼‰å±æ€§ä¸Šä½¿ç”¨ã€è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­æ²¡æœ‰è¿™ä¸ªå­—æ®µå°±å¿½ç•¥ï¼›
2. @TableField
   è¯¥æ³¨è§£åªé€‚ç”¨äºmybatis-plusæ¡†æ¶ï¼š
   @TableField(exist = false)ï¼šè¡¨ç¤ºè¯¥å±æ€§ä¸ä¸ºæ•°æ®åº“è¡¨å­—æ®µï¼Œä½†åˆæ˜¯å¿…é¡»ä½¿ç”¨çš„ã€‚
   @TableField(exist = true)ï¼šè¡¨ç¤ºè¯¥å±æ€§ä¸ºæ•°æ®åº“è¡¨å­—æ®µã€‚

## 2.é˜¿é‡ŒEasyExcelå¤§æ•°æ®å¯¼å…¥ç”¨æ³•
pomæ–‡ä»¶ä¾èµ–
```xml
<!--é˜¿é‡Œå·´å·´EasyExcelä¾èµ–-->
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.0.5</version>
</dependency>
```
å¯¼å…¥ï¼ˆè¯»ï¼‰æ•°æ®â€“ç¬¬ä¸€æ­¥åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨ExcelDataListener.javaç»§æ‰¿AnalysisEventListenerç±»
```java
// 1.ç¼–å†™ä¸€ä¸ªç›‘å¬å™¨ ExcelDataListener.javaç»§æ‰¿AnalysisEventListenerç±»
//    é‡å†™invokeæ–¹æ³•
package com.xiaogui.log.utils;

import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.event.AnalysisEventListener;
import com.alibaba.excel.metadata.Cell;
import com.alibaba.excel.read.metadata.holder.ReadRowHolder;
import com.alibaba.excel.support.ExcelTypeEnum;
import com.alibaba.fastjson.JSON;
import com.xiaogui.log.mapper.LogMapper;
import com.xiaogui.log.vo.resp.RespLogInfo;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;
import java.util.*;

@Component
@Slf4j
public class ExcelDataListener extends AnalysisEventListener<RespLogInfo> {
/**
* æ¯éš”10æ¡å­˜å‚¨æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­å¯ä»¥3000æ¡ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶
*/
private static final int BATCH_COUNT = 10;
List<ä¸Excelè¡¨å¤´å¯¹åº”çš„Entity> list = new ArrayList<>();
/**
* å‡è®¾è¿™ä¸ªæ˜¯ä¸€ä¸ªDAOï¼Œå½“ç„¶æœ‰ä¸šåŠ¡é€»è¾‘è¿™ä¸ªä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªserviceã€‚
* å½“ç„¶å¦‚æœä¸ç”¨å­˜å‚¨è¿™ä¸ªå¯¹è±¡æ²¡ç”¨ã€‚
*/
private final RespLogInfoService respLogInfoService;

    /**
     * å¦‚æœä½¿ç”¨äº†spring,è¯·ä½¿ç”¨è¿™ä¸ªæ„é€ æ–¹æ³•ã€‚
     * æ¯æ¬¡åˆ›å»ºListenerçš„æ—¶å€™éœ€è¦æŠŠspringç®¡ç†çš„ç±»ä¼ è¿›æ¥
     */
    public ExcelDataListener(RespLogInfoService respLogInfoService) {
        this.respLogInfoService = respLogInfoService;
    }

    /**
     * è¿™ä¸ªæ¯ä¸€æ¡æ•°æ®è§£æéƒ½ä¼šæ¥è°ƒç”¨
     */
    @Override
    public void invoke(ä¸Excelè¡¨å¤´å¯¹åº”çš„Entity data, AnalysisContext context) {
        log.info("è§£æåˆ°ä¸€æ¡æ•°æ®:{}", JSON.toJSONString(data));
        list.add(data);
        // è¾¾åˆ°BATCH_COUNTäº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM
        if (list.size() >= BATCH_COUNT) {
            respLogInfoService.saveOrUpdateBatch(list);
            // å­˜å‚¨å®Œæˆæ¸…ç† list
            list.clear();
        }
    }

    /**
     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨
     */
    @Override
    public void doAfterAllAnalysed(AnalysisContext context) {
        respLogInfoService.saveOrUpdateBatch(list);
        log.info("æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼");
    }
}
```
å®ä½“ç±»
```java
public class RespLogInfo implements Serializable {
    @ExcelProperty(index = 0)//å¯¹åº”excelç¬¬å‡ åˆ—
    private String type;//å¼€æ”¯ç±»å‹ ä¿¡ç”¨å¡ç­‰
```
ç”¨æ³•
```java
package easyExcel;

import com.alibaba.excel.EasyExcel;
import com.easyexcel.listener.EasyExcelOrderListener;
import com.easyexcel.pojo.ExcelOrder;
import org.junit.Test;
/***
* easyExcelæµ‹è¯•ç±»
  ***/
  public class ExcelReadTest {
  @Test
  public void excelRead(){
  //String fileName = "æ–‡ä»¶è·¯å¾„/è®¢å•è¡¨.xlsx";//æ–‡ä»¶è·¯å¾„
  //é»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªsheet
  //EasyExcel.read(fileName, ExcelOrder.class,new EasyExcelOrderListener()).sheet().doRead();
  //æˆ–è€…å¦‚ä¸‹æ–¹æ³•
  EasyExcel.read(file.getInputStream, RespLogInfo.class,new FileListener(this)).sheet().doRead();
  }
  }
```

## 3.ä¸¤ä¸ªå®ä½“ç±»äº’ç›¸copy
```java
BeanUtils.copyProperties(è¢«copyEntity,targetEntity);
```

## 4.å®ä½“Entityè½¬Map
```java
Map<String,String> oMapper = new ObjectMapper().convertValue(clerk, HashMap.class);
```
## 5.å¸¸é‡çš„å®šä¹‰
```java
public static final String MONDAY = "test";
  public static final Map map = new HashMap();
  static {
  map.put("key1", "value1");
  map.put("key2", "value2");
  }
  //æˆ–è€…
  public static final Map<String, String> map = new HashMap<>() {
  {
  put("key1", "value1");
  put("key2", "value2");
  }
  };
  //Listå¸¸é‡å®šä¹‰æ–¹å¼
  public static final List<String> list = Arrays.asList("88","99","100");
```
## 6.SpringBootä½¿ç”¨RequestBodyAdviceè¿›è¡Œç»Ÿä¸€å‚æ•°å¤„ç†
è¯·æ±‚å¤„ç†====åœ¨å®é™…é¡¹ç›®ä¸­ , å¾€å¾€éœ€è¦å¯¹è¯·æ±‚å‚æ•°åšä¸€äº›ç»Ÿä¸€çš„æ“ä½œ , ä¾‹å¦‚å‚æ•°çš„è¿‡æ»¤ , å­—ç¬¦çš„ç¼–ç  , ç¬¬ä¸‰æ–¹çš„è§£å¯†ç­‰ç­‰ , Springæä¾›äº†RequestBodyAdviceä¸€ä¸ªå…¨å±€çš„è§£å†³æ–¹æ¡ˆ , å…å»äº†æˆ‘ä»¬åœ¨Controllerå¤„ç†çš„ç¹ç .RequestBodyAdviceä»…å¯¹ä½¿ç”¨äº†@RqestBodyæ³¨è§£çš„ç”Ÿæ•ˆ , å› ä¸ºå®ƒåŸç†ä¸Šè¿˜æ˜¯AOP , æ‰€ä»¥GETæ–¹æ³•æ˜¯ä¸ä¼šæ“ä½œçš„
```java
package com.xbz.common.web;
  import org.springframework.core.MethodParameter;
  import org.springframework.http.HttpHeaders;
  import org.springframework.http.HttpInputMessage;
  import org.springframework.http.converter.HttpMessageConverter;
  import org.springframework.web.bind.annotation.ControllerAdvice;
  import org.springframework.web.servlet.mvc.method.annotation.RequestBodyAdvice;
  import java.io.IOException;
  import java.io.InputStream;
  import java.lang.reflect.Type;

/**
* @title å…¨å±€è¯·æ±‚å‚æ•°å¤„ç†ç±»
* @author Xingbz
* @createDate 2019-8-2
  */
  @Component
  //@ControllerAdvice(basePackages = "com.xbz.controller")//æ­¤å¤„è®¾ç½®éœ€è¦å½“å‰Adviceæ‰§è¡Œçš„åŸŸ , çœç•¥é»˜è®¤å…¨å±€ç”Ÿæ•ˆ
  @ControllerAdvice(assignableTypes = {TestController.class})//ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹å¼ è®©å•ä¸ªcontrollerç”Ÿæ•ˆ
  public class GlobalRequestBodyAdvice implements RequestBodyAdvice {
  private final Logger log = LoggerFactory.getLogger(getClass());

  /** æ­¤å¤„å¦‚æœè¿”å›false , åˆ™ä¸æ‰§è¡Œå½“å‰Adviceçš„ä¸šåŠ¡ */
  @Override
  public boolean supports(MethodParameter methodParameter, Type targetType, Class<? extends HttpMessageConverter<?>> converterType) {
  //        return methodParameter.getMethod().isAnnotationPresent(XXApiReq.class);
  return true;
  }

  /**
    * @title è¯»å–å‚æ•°å‰æ‰§è¡Œ
    * @description åœ¨æ­¤åšäº›ç¼–ç  / è§£å¯† / å°è£…å‚æ•°ä¸ºå¯¹è±¡çš„æ“ä½œ
    *
    *  */
       @Override
       public HttpInputMessage beforeBodyRead(HttpInputMessage inputMessage, MethodParameter parameter, Type targetType, Class<? extends HttpMessageConverter<?>> converterType) throws IOException {
       //return new XHttpInputMessage(inputMessage, "UTF-8");
       return inputMessage;
       }

  /**
    * @title è¯»å–å‚æ•°åæ‰§è¡Œ  è§£å¯†ç­‰çš„æ“ä½œåŒºåŸŸ
    * @author Xingbz
      */
      @Override
      public Object afterBodyRead(Object body, HttpInputMessage inputMessage, MethodParameter parameter, Type targetType, Class<? extends HttpMessageConverter<?>> converterType) {
      log.info("ç¬¬ä¸‰æ–¹è¯·æ±‚åŠ å¯†æ•°æ®ï¼š"+body)
      //è§£å¯† todo
      String aaa = body;
      return aaa;
      }

  /**
    * @title æ— è¯·æ±‚æ—¶çš„å¤„ç†
      */
      @Override
      public Object handleEmptyBody(Object body, HttpInputMessage inputMessage, MethodParameter parameter, Type targetType, Class<? extends HttpMessageConverter<?>> converterType) {
      return body;
      }
      }
```
å“åº”å¤„ç†=====å®ç°ResponseBodyAdviceæ¥å£ï¼Œå…¶å®æ˜¯å¯¹åŠ äº†@RestController(ä¹Ÿå°±æ˜¯@Controller+@ResponseBody)æ³¨è§£çš„å¤„ç†å™¨å°†è¦è¿”å›çš„å€¼è¿›è¡Œå¢å¼ºå¤„ç†ã€‚
å…¶å®ä¹Ÿå°±æ˜¯é‡‡ç”¨äº†AOPçš„æ€æƒ³ï¼Œå¯¹è¿”å›å€¼è¿›è¡Œä¸€æ¬¡ä¿®æ”¹ã€‚
```java
 //æ­¤æ¥å£è¯´æ˜å¯¹æ·»åŠ äº†@Controllerçš„ç±»ç»‡å…¥ä¸€ä¸ªé€šçŸ¥(å¢å¼ºåŠŸèƒ½)
      @ControllerAdvice(assignableTypes = {TestController.class})
      @Component
      public class MyResponseBodyAdvice implements ResponseBodyAdvice {
      private final Logger log = LoggerFactory.getLogger(getClass());

  @Override
  public boolean supports(MethodParameter returnType, Class converterType) {
  // å¼€å…³å¤„äºå¼€å¯çŠ¶æ€  æ˜¯getè¯·æ±‚  
  //ä½¿ç”¨MethodParameterå‚æ•°åˆ¤æ–­æ³¨è§£ä¿¡æ¯
  //ç¬¦åˆæ­¤Getè¯·æ±‚æ‰è¿›è¡Œç»‡å…¥é€šçŸ¥
  //return enable && returnType.hasMethodAnnotation(GetMapping.class)
  return true;
  }

  /**
  *@param bodyï¼šåŸcontrollerè¦è¿”å›çš„å†…å®¹
  åŠ å¯†æ“ä½œç­‰
  */
  @Override
  public Object beforeBodyWrite(Object body, MethodParameter returnType, MediaType selectedContentType, Class selectedConverterType, ServerHttpRequest request, ServerHttpResponse response) {
  log.info("å“åº”ç¬¬ä¸‰æ–¹æ•°æ®åŠ å¯†å¤„ç†å¼€å§‹ï¼š"+body)
  //åŠ å¯†å¤„ç† todo
  String sendXml = body;
  return sendXml;
  }
  }
```
## 7.vueä¸­å°†åå°è¿”å›çš„æ•°å­—è½¬æ¢æˆå¯¹åº”çš„æ–‡å­—
### 7.1ã€å¯¹äºåˆ—è¡¨å¾ªç¯el-table-columné‡‡ç”¨å¦‚ä¸‹æ–¹å¼ï¼š
```java
  ç¬¬ä¸€ç§æ–¹æ¡ˆ
<el-table-column prop="status" :show-overflow-tooltip="true" label="çŠ¶æ€" width="60" :formatter="statusFormatter">
</el-table-column>ji

        methods:{
        statusFormatter(row, column){
        }
        }
        ç¬¬äºŒç§æ–¹æ¡ˆ
<el-table-column prop="type" label="ç±»å‹" align="center">
<template v-slot="{ row }">
<span v-show="row.type == 1">æ™®é€šç”¨æˆ·</span>
<span v-show="row.type == 2">ç®¡ç†å‘˜</span>
<span v-show="row.type == 3">é¡¹ç›®ç»ç†</span>
</template>
</el-table-column>
```
### 7.2ã€å¯¹äºè¯¦æƒ…æˆ–è€…ä¿®æ”¹é¡µé¢é‡‡ç”¨å¦‚ä¸‹æ–¹å¼ï¼š
```java
åœ¨Vueä¸­ï¼Œcreatedå’Œmountedçš„åŒºåˆ«æ˜¯createdç”¨æ¥åˆå§‹åŒ–å±æ€§å€¼ï¼Œmountedç”¨æ¥æ“ä½œå±æ€§å€¼ã€‚ä¸‹é¢å°ç¼–ä¸¾ä¾‹è®²è§£Vueä¸­createdå’Œmountedçš„åŒºåˆ«æ˜¯ä»€ä¹ˆã€‚
createdæ˜¯ç”¨æ¥åˆå§‹åŒ–é¡µé¢çš„å€¼çš„
mountedæ˜¯ä¿®æ”¹é¡µé¢çš„å€¼çš„
created() {
console.log(this.dataMsg);
console.log(this.propMsg);
},
mounted() {
console.log(this.dataMsg);
this.submit()
console.log(this.propMsg);
}
ä¸Šé¢æ–¹æ³•mountedæœ‰å¯èƒ½åªè§¦å‘ä¸€æ¬¡ï¼Œå°±æ˜¯è¯´è¯¦æƒ…é¡µé¢å…³é—­åå†æ‰“å¼€mountedä¸­çš„æ–¹æ³•ä¸ä¼šå†æ¬¡æ‰§è¡Œã€‚
å®Œç¾æ–¹æ¡ˆv-modelç»‘å®šè®¡ç®—å±æ€§ï¼š
<el-form-item>
<span slot="label">
<i class="el-icon-edit"></i>
æ´»åŠ¨åç§°
</span>
<el-input v-model="formatValue"></el-input>
</el-form-item>
è®¡ç®—å±æ€§å®šä¹‰
computed: {
formatValue() {
if(this.inputvalue === '0'){
return "ä¸­å›½";
}
}
}ï¼Œ
```
## 8.å®ä½“ç±»å±æ€§copy
```java
BeanUtils.copyProperties(source,target);
```
## 9.el-table-columnå®½åº¦è‡ªé€‚åº”
```java
å¦‚ä¸‹è¿™ç§æ–¹å¼ä¼šæŠŠæ¯åˆ—å®½åº¦è®¾ç½®ä¸º10px
<el-table-column
prop="sort"
label="Sort"
width="10%">
å¦‚ä¸‹æ˜¯ç™¾åˆ†æ¯”çš„å†™æ³•
<el-table-column prop="sort" label="Sort" min-width="50%">
<el-table-column prop="sort" label="Sort" min-width="50%">
```
## 10.el-tableè¡¨æ ¼ä¸­å•å…ƒæ ¼å†…å®¹è¿‡å¤šæ˜¾ç¤ºçœç•¥å·
```java
el-tableè¡¨æ ¼ä¸­å†…å®¹è¶…å‡ºå•å…ƒæ ¼çš„å®½åº¦ä¼šè‡ªåŠ¨æ¢è¡Œï¼Œä¼šä½¿æ•´ä¸ªè¡¨æ ¼çœ‹èµ·æ¥æ˜¾å¾—ä¸å¤ªç¾è§‚ï¼Œ
æ­¤æ—¶å¯ä»¥ä½¿ç”¨el-table-column è‡ªå¸¦çš„ show-overflow-tooltip="true"  å±æ€§æ¥è®¾ç½®ï¼Œå¯ä»¥ä½¿è¶…å‡ºå•å…ƒæ ¼å®½åº¦çš„å†…å®¹å˜æˆçœç•¥å·ï¼Œ
è€Œä¸”é¼ æ ‡æ”¾ä¸Šå»ä¼šæç¤ºå•å…ƒæ ¼ä¸­åŸæœ¬æœ‰çš„å…¨éƒ¨çš„å†…å®¹
<el-table-column
prop="address"
label="åœ°å€"
show-overflow-tooltip="true"
min-width="100">

</el-table-column>
```
## 11.mybatis-plusçš„LambdaQueryWrapperè‡ªå®šä¹‰sqlç”¨æ³•
```java
# å¦‚æœæ’åºçš„å­—æ®µéœ€è¦å…ˆè½¬æ¢ç±»å‹å‘¢
# é‚£ä¹ˆå°±éœ€è¦ sqlè‡ªç”±æ‹¼æ¥æ–¹æ³• ï¼ˆwrapper.applyï¼‰
    @Override
    public List<SysRoleEntity> selectListByTypeCode(String typeCode) {
        LambdaQueryWrapper<SysRoleEntity> wrapper = new LambdaQueryWrapper<SysRoleEntity>()
                .eq(SysRoleEntity::getTypeCode,typeCode)

                .apply("ORDER BY TO_NUMBER(SEQUENCEVALUE) ASC");
    }
æˆ–è€…
apply("date_format(dateColumn,'%Y-%m-%d') = {0}", "2020-10-08")
```
## 12.mybatis-plusçš„@Selectæ³¨è§£ç”¨æ³•
```java
//æ²¡æœ‰æŸ¥è¯¢æ¡ä»¶
@Select("select BLOCK_ID,BLOCK_NAME,PARENT_BLOCK_ID,BLOCK_LEVEL,ORDER_NUM from XY_DIC_BLOCK_T where block_level=1 " )
public List<Block> sqlMany();
//æœ‰æŸ¥è¯¢æ¡ä»¶
@Select("select BLOCK_ID,BLOCK_NAME,PARENT_BLOCK_ID,BLOCK_LEVEL,ORDER_NUM from XY_DIC_BLOCK_T where block_level=#{level}"    )
public List<Block> sqlManyParm(String level);
//sqlä¸­æœ‰æ¡ä»¶åˆ¤æ–­
@Select("<script> select BLOCK_ID,BLOCK_NAME,PARENT_BLOCK_ID,BLOCK_LEVEL,ORDER_NUM from XY_DIC_BLOCK_T where 1=1 " +
"<if test='level != null'>" + " and block_level=#{level} " + "</if>" +
"</script>")
public List<Block> sqlManyParmNull(String level);
//sqlä¸­æœ‰æ¡ä»¶åˆ¤æ–­å¹¶ä¸”ä¼ é€’å‚æ•°æ—¶ä¸ªå¯¹è±¡çš„æƒ…å†µ
@Select("<script> select BLOCK_ID,BLOCK_NAME,PARENT_BLOCK_ID,BLOCK_LEVEL,ORDER_NUM from XY_DIC_BLOCK_T where 1=1 " +
"<if test='item.blockLevel != null'>" + " and block_level=#{item.blockLevel} " + "</if>" +
"</script>")
public List<Block> sqlManyObject(@Param("item") Block block);
```
## 13.vueè°ƒç”¨å­ç»„ä»¶ä½œä¸ºå¼¹çª—æ—¶åªæ‰§è¡Œä¸€æ¬¡createdé—®é¢˜
è§£å†³åŠæ³•ï¼šç”¨v-ifå°†å­ç»„ä»¶åŒ…è£¹èµ·æ¥ï¼Œå› ä¸ºv-if=falseæ—¶å¯ä»¥å°†å­ç»„ä»¶é”€æ¯æ‰ï¼Œå†æ¬¡è°ƒç”¨æ—¶é‡æ–°æ¸²æŸ“
è¡¥å……çŸ¥è¯†ï¼švueå¦‚ä½•æ¯æ¬¡æ‰“å¼€å­ç»„ä»¶å¼¹çª—éƒ½è¿›è¡Œåˆå§‹åŒ–       :visible.sync ä¸ v-ifåŒæ—¶ä½¿ç”¨å³å¯

![](https://fsvip.gitee.io/imgs/pic/41009/3dd66.jpg)

## 14.Javaå­—ç¬¦ä¸²å‰åè¡¥é›¶çš„å‡ ç§æ–¹æ³•
æ•°å­—ç±»å‹å‰è¡¥ 0
```java
String.format("%08d", 123);    // 00000123
```
å­—ç¬¦ä¸²ç±»å‹å‰è¡¥ 0
```java
String.format("%8s", "abc").replace(" ", "0");
// 00000abc
```
ä¹Ÿå¯ä»¥å…ˆåœ¨å‰é¢è¡¥ 8 ä½çš„ 0ï¼Œå†æˆªå–ï¼š
```java
String str = "00000000" + "abc";
str.substring(str.length() - 8);
// 00000abc
```
åè¡¥ 0
å¯¹äºåè¡¥ 0ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ä¸€ç§æ–¹å¼æ¥åšï¼Œå°±æ˜¯åœ¨åé¢åŠ ä¸Š 00000...ï¼Œä¹‹åæˆªå–ï¼š
```java
(123 + "00000000").substring(0, 8);
// 12300000
```
è¿™ç§æ–¹å¼é€šç”¨ä»»ä½•ç±»å‹

## 15.springbooté›†æˆhttps
```java
ç”Ÿæˆè¯ä¹¦
keytool -genkey -alias tomcat -dname "CN=Andy,OU=kfit,O=kfit,L=HaiDian,ST=BeiJing,C=CN" -storetype PKCS12 -keyalg RSA -keysize 2048 -keystore keystore.p12 -validity 365
è¯´æ˜ï¼š"CN=åå­—ä¸å§“æ°,OU=ç»„ç»‡å•ä½åç§°,O=ç»„ç»‡åç§°,L=åŸå¸‚æˆ–åŒºåŸŸåç§°,ST=å·æˆ–çœä»½åç§°,C=å•ä½çš„ä¸¤å­—æ¯å›½å®¶ä»£ç "
```
è¾“å…¥åä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œè¿™ä¸ªå¯†ç åœ¨ä¸‹é¢é…ç½®æ–‡ä»¶æœ‰ç”¨åˆ°ã€‚
ç”Ÿæˆåï¼Œåœ¨å®¶ç›®å½•æ‰¾åˆ°è¯ä¹¦æ–‡ä»¶ï¼Œå¤åˆ¶åˆ°SpringBootåº”ç”¨çš„src/main/resourcesä¸‹
```yml
application.ymlé…ç½®å¦‚ä¸‹ä¿¡æ¯
server:
ssl:
# è¯ä¹¦è·¯å¾„
key-store: classpath:keystore.p12
# ä¸ç”³è¯·æ—¶è¾“å…¥ä¸€è‡´
key-alias: tomcat
enabled: true
key-store-type: PKCS12
#ä¸ç”³è¯·æ—¶è¾“å…¥ä¸€è‡´
key-store-password: 123456
# æµè§ˆå™¨é»˜è®¤ç«¯å£ å’Œ 80 ç±»ä¼¼ï¼Œhttpsé»˜è®¤çš„ç«¯å£å·ä¸º443
port: 443
è¯´æ˜ï¼šç«¯å£443å¯ä»¥æ”¹æˆä»»æ„å€¼
```
æ­¤æ—¶å¯åŠ¨SpringBootåº”ç”¨ï¼Œå‘ç°å¯ä»¥é€šè¿‡httpsè®¿é—®äº†====å¿«å»æ‰“å¼€æµè§ˆå™¨è®¿é—®è¯•è¯•ğŸ˜‰ã€‚
æƒ³è¦httpåŒæ—¶è®¿é—®å°±çœ‹ä¸‹é¢ï¼Œå¦åˆ™è·³è¿‡
```java
åœ¨ymlé…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ httpç«¯å£å·å®šä¹‰
server
http:
port: 8888
åˆ›å»ºé…ç½®ç±»
@Value("${server.http.port}")
private Integer httpPort;

@Bean
public ServletWebServerFactory servletContainer(){
final Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
connector.setPort(httpPort);
final TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory();

    tomcat.addAdditionalTomcatConnectors(connector);
    return tomcat;
}
å¯åŠ¨é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¦‚ä¸‹æ—¥å¿—ï¼ŒTomcatç»‘å®šäº†ä¸¤ä¸ªç«¯å£å·ï¼Œå…¶ä¸­httpsç»‘å®šåœ¨8080ï¼Œhttpç»‘å®šåœ¨8888ã€‚
æ­å–œä½ é€šå…³
```
## 16.é¡¹ç›®é˜²åˆ·æ§åˆ¶(è‡ªå®šä¹‰æ³¨è§£)
### åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£
```java
package com.example.annotation;
import java.lang.annotation.*;

@Documented
@Inherited
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface AccessLimit {
int seconds() default 1;
int maxCount() default 1;
}
```
### 2.åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ (ç”¨äºæ‹¦æˆªè¯·æ±‚,æ›´æ–°å½“å‰ç”¨æˆ·è®¿é—®çš„æ¬¡æ•°,å¦‚æœè®¿é—®å—é™,åˆ™è¿”å›è¶…æ—¶çš„çŠ¶æ€ç )
```java
package com.example.interceptor;

import com.example.annotation.AccessLimit;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Component;
import org.springframework.web.method.HandlerMethod;
import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;
import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.OutputStream;
import java.util.concurrent.TimeUnit;

@Component
public class FangshuaInterceptor extends HandlerInterceptorAdapter {
@Resource
RedisTemplate<String, Object> redisTemplate;
@Override
public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
if (handler instanceof HandlerMethod) {
HandlerMethod handler1 = (HandlerMethod) handler;
//       3. è·å–æ–¹æ³•ä¸­çš„æ³¨è§£,çœ‹æ˜¯å¦æœ‰è¯¥æ³¨è§£
AccessLimit accessLimit = handler1.getMethodAnnotation(AccessLimit.class);
if (accessLimit != null) {
//                3.2 ï¼š åˆ¤æ–­è¯·æ±‚æ˜¯å¦å—é™åˆ¶
if (isLimit(request, accessLimit)) {
render(response, "{\"code\":\"30001\",\"message\":\"è¯·æ±‚è¿‡å¿«\"}");
return false;
}
}
}
return true;
}

    //åˆ¤æ–­è¯·æ±‚æ˜¯å¦å—é™
    public boolean isLimit(HttpServletRequest request, AccessLimit accessLimit) {
        // å—é™çš„redis ç¼“å­˜key ,å› ä¸ºè¿™é‡Œç”¨æµè§ˆå™¨åšæµ‹è¯•ï¼Œæˆ‘å°±ç”¨sessionid æ¥åšå”¯ä¸€key,å¦‚æœæ˜¯app ,å¯ä»¥ä½¿ç”¨ ç”¨æˆ·ID ä¹‹ç±»çš„å”¯ä¸€æ ‡è¯†ã€‚
        String limitKey = request.getServletPath() + request.getSession().getId();
        // ä»ç¼“å­˜ä¸­è·å–ï¼Œå½“å‰è¿™ä¸ªè¯·æ±‚è®¿é—®äº†å‡ æ¬¡
        Integer redisCount = (Integer) redisTemplate.opsForValue().get(limitKey);
        if (redisCount == null) {
            //åˆå§‹ æ¬¡æ•°
            redisTemplate.opsForValue().set(limitKey, 1, accessLimit.seconds(), TimeUnit.SECONDS);
            System.out.println("å†™å…¥redis --");
        } else {
            System.out.println("intValue-->" + redisCount.intValue());
            if (redisCount.intValue() >= accessLimit.maxCount()) {
                return true;
            }
            // æ¬¡æ•°è‡ªå¢
            redisTemplate.opsForValue().increment(limitKey);
        }
        return false;
    }

    private void render(HttpServletResponse response, String cm) throws Exception {
        response.setContentType("application/json;charset=UTF-8");
        OutputStream out = response.getOutputStream();
        out.write(cm.getBytes("UTF-8"));
        out.flush();
        out.close();
    }
}
```
### 3.æ³¨å†Œæ‹¦æˆªå™¨
```java
package com.example.interceptor;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
import java.io.Serializable;

@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {
@Autowired
private FangshuaInterceptor interceptor;
@Override
public void addInterceptors(InterceptorRegistry registry) {
registry.addInterceptor(interceptor);
}
//å¦‚æœredisTemplate.opsForValue().increment(limitKey);çš„incrementæ–¹æ³•æŠ¥é”™æ·»åŠ è¿™ä¸ªæ–¹æ³•
@Bean
public RedisTemplate<String, Serializable> redisTemplate(LettuceConnectionFactory connectionFactory) {
//åˆ›å»º redisTemplate æ¨¡ç‰ˆ
RedisTemplate<String, Serializable> redisTemplate = new RedisTemplate<>();
//è®¾ç½® value çš„è½¬åŒ–æ ¼å¼å’Œ key çš„è½¬åŒ–æ ¼å¼
redisTemplate.setKeySerializer(new StringRedisSerializer());
redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
//å…³è” redisConnectionFactory
redisTemplate.setConnectionFactory(connectionFactory);
return redisTemplate;
}
}
```
### 4.OK , ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥åœ¨éœ€è¦è¿›è¡Œç°åœ¨è®¿é—®æ¬¡æ•°çš„controllerä¸­çš„æ–¹æ³•ä½¿ç”¨è¯¥æ³¨è§£äº†
```java
@RestController
@RequestMapping("/test")
public class Test {
@GetMapping("/test1")
//    æŒ‡å®šæ­¤æ¥å£åŒä¸€ä¸ªç”¨æˆ·åœ¨20ç§’å†…åªèƒ½è®¿é—®2æ¬¡
@AccessLimit(seconds = 20, maxCount = 2)
public String test1() {
return "æˆ‘æ˜¯test1";
}
}
```
## 17.stringè½¬json
```java
JSONObject  json=new  JSONObjectï¼ˆâ€œâ€ï¼‰ï¼›
String  key  =  json.getStringï¼ˆkeyï¼‰ï¼›
```
## 18.SpringBooté¡¹ç›®ä¸šåŠ¡æ“ä½œæ—¥å¿—è®°å½•
### 1ã€ä¾èµ–é…ç½®
```xml
<dependency>
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-aop</artifactId>
</dependency>
```
### 2ã€è¡¨ç»“æ„è®¾è®¡
```sql
create table if not exists bus_log(
id bigint auto_increment comment 'è‡ªå¢id'
primary key,
bus_name varchar(100) null comment 'ä¸šåŠ¡åç§°',
bus_descrip varchar(255) null comment 'ä¸šåŠ¡æ“ä½œæè¿°',
oper_person varchar(100) null comment 'æ“ä½œäºº',
oper_time datetime null comment 'æ“ä½œæ—¶é—´',
ip_from varchar(50) null comment 'æ“ä½œæ¥æºip',
param_file varchar(255) null comment 'æ“ä½œå‚æ•°æŠ¥æ–‡æ–‡ä»¶'
)comment 'ä¸šåŠ¡æ“ä½œæ—¥å¿—' default charset ='utf8';
```
### 3ã€å®šä¹‰ä¸šåŠ¡æ—¥å¿—æ³¨è§£@BusLogï¼Œå¯ä»¥ä½œç”¨åœ¨æ§åˆ¶å™¨æˆ–å…¶ä»–ä¸šåŠ¡ç±»ä¸Šï¼Œç”¨äºæè¿°å½“å‰ç±»çš„åŠŸèƒ½ï¼›ä¹Ÿå¯ä»¥ç”¨äºæ–¹æ³•ä¸Šï¼Œç”¨äºæè¿°å½“å‰æ–¹æ³•çš„ä½œç”¨
```java
/** * ä¸šåŠ¡æ—¥å¿—æ³¨è§£ * å¯ä»¥ä½œç”¨åœ¨æ§åˆ¶å™¨æˆ–å…¶ä»–ä¸šåŠ¡ç±»ä¸Šï¼Œç”¨äºæè¿°å½“å‰ç±»çš„åŠŸèƒ½ï¼› * ä¹Ÿå¯ä»¥ç”¨äºæ–¹æ³•ä¸Šï¼Œç”¨äºæè¿°å½“å‰æ–¹æ³•çš„ä½œç”¨ï¼› */
@Target({ElementType.METHOD,ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface BusLog {  
/**     * åŠŸèƒ½åç§°     * @return     */
String name() default "";
/**     * åŠŸèƒ½æè¿°     * @return     */
String descrip() default "";
}
```
### 4ã€æŠŠä¸šåŠ¡æ“ä½œæ—¥å¿—æ³¨è§£BusLogæ ‡è®°åœ¨PersonControllerç±»å’Œæ–¹æ³•ä¸Š
```java
@RestController
@Slf4j
@BusLog(name = "äººå‘˜ç®¡ç†")
@RequestMapping("/person")
public class PersonController {
@Autowired
private IPersonService personService;
private Integer maxCount=100;

    @PostMapping
    @NeedEncrypt
    @BusLog(descrip = "æ·»åŠ å•æ¡äººå‘˜ä¿¡æ¯")
    public Person add(@RequestBody Person person) {
        Person result = this.personService.registe(person);
        log.info("//å¢åŠ personæ‰§è¡Œå®Œæˆ");
        return result;
    }
}
```
### 5ã€ç¼–å†™åˆ‡é¢ç±»BusLogAopï¼Œå¹¶ä½¿ç”¨@BusLogå®šä¹‰åˆ‡å…¥ç‚¹ï¼Œåœ¨ç¯ç»•é€šçŸ¥å†…æ‰§è¡Œè¿‡ç›®æ ‡æ–¹æ³•åï¼Œè·å–ç›®æ ‡ç±»ã€ç›®æ ‡æ–¹æ³•ä¸Šçš„ä¸šåŠ¡æ—¥å¿—æ³¨è§£ä¸Šçš„åŠŸèƒ½åç§°å’ŒåŠŸèƒ½æè¿°ï¼Œ æŠŠæ–¹æ³•çš„å‚æ•°æŠ¥æ–‡å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€åä¿å­˜ä¸šåŠ¡æ“ä½œæ—¥å¿—ä¿¡æ¯
```java
@Component
@Aspect
@Slf4j
public class BusLogAop implements Ordered {
@Autowired
private BusLogDao busLogDao;

    /**     * å®šä¹‰BusLogAopçš„åˆ‡å…¥ç‚¹ä¸ºæ ‡è®°@BusLogæ³¨è§£çš„æ–¹æ³•     */
    @Pointcut(value = "@annotation(com.fanfu.anno.BusLog)")
    public void pointcut() {
    }
 
    /**     * ä¸šåŠ¡æ“ä½œç¯ç»•é€šçŸ¥     *     * @param proceedingJoinPoint     * @retur     */
    @Around("pointcut()")
    public Object around(ProceedingJoinPoint proceedingJoinPoint) {
        log.info("----BusAop ç¯ç»•é€šçŸ¥ start");
        //æ‰§è¡Œç›®æ ‡æ–¹æ³•
        Object result = null;
        try {
            result = proceedingJoinPoint.proceed();
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
        //ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œè·å–ç›®æ ‡ç±»ã€ç›®æ ‡æ–¹æ³•ä¸Šçš„ä¸šåŠ¡æ—¥å¿—æ³¨è§£ä¸Šçš„åŠŸèƒ½åç§°å’ŒåŠŸèƒ½æè¿°
        Object target = proceedingJoinPoint.getTarget();
        Object[] args = proceedingJoinPoint.getArgs();
        MethodSignature signature = (MethodSignature) proceedingJoinPoint.getSignature();
        BusLog anno1 = target.getClass().getAnnotation(BusLog.class);
        BusLog anno2 = signature.getMethod().getAnnotation(BusLog.class);
        BusLogBean busLogBean = new BusLogBean();
        String logName = anno1.name();
        String logDescrip = anno2.descrip();
        busLogBean.setBusName(logName);
        busLogBean.setBusDescrip(logDescrip);
        busLogBean.setOperPerson("fanfu");
        busLogBean.setOperTime(new Date());
        JsonMapper jsonMapper = new JsonMapper();
        String json = null;
        try {
            json = jsonMapper.writeValueAsString(args);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
        }
        //æŠŠå‚æ•°æŠ¥æ–‡å†™å…¥åˆ°æ–‡ä»¶ä¸­
        OutputStream outputStream = null;
        try {
            String paramFilePath = System.getProperty("user.dir") + File.separator + DateUtil.format(new Date(), DatePattern.PURE_DATETIME_MS_PATTERN) + ".log";
            outputStream = new FileOutputStream(paramFilePath);
            outputStream.write(json.getBytes(StandardCharsets.UTF_8));
            busLogBean.setParamFile(paramFilePath);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (outputStream != null) {
                try {
                    outputStream.flush();
                    outputStream.close();
                } catch (IOException e) {
                    e.printStackTrace();
                } 
            }
        }
        //ä¿å­˜ä¸šåŠ¡æ“ä½œæ—¥å¿—ä¿¡æ¯
        this.busLogDao.insert(busLogBean);
        log.info("----BusAop ç¯ç»•é€šçŸ¥ end");
        return result;
    }
 
    @Override
    public int getOrder() {
        return 1;
    }
}
```
## 19.jacksonè¿”å›å‰ç«¯çš„å­—ç¬¦ä¸²ä¸­å¼•å·è¢«è‡ªåŠ¨åŠ ä¸Šåæ–œæ†
- å¯¹è±¡ä¸­æœ‰å­—ç¬¦ä¸²æ˜¯è¿”å›çš„å¯¹è±¡ä¸­æœ‰åæ–œæ†
```json
{\"networkNumber\": 1}
```
è§£å†³æ–¹æ³•ï¼š
ä½¿ç”¨JsonNode
```java
    class DtoNew {
      JsonNode data;
    }
    ObjectMapper mapper = new ObjectMapper();
    try {
        dtoNew.data =  mapper.readTree(dto.data ));
    } catch (IOException e) {
        e.printStackTrace();
    }
```
å®é™…ä½¿ç”¨æ–¹æ³•
```java
@JsonIgnore
private String preserveList;

private JsonNode preserve_list;

public JsonNode getPreserve_list(){
        try {
            return new ObjectMapper().readTree(this getPreserveList());
        }catch (JsonProcessingException e) {
            e.printStackTrace();
            return null;
        }
}
```
- å¯¹è±¡ä¸­å­—æ®µè½¬æ¢jsonè¾“å‡ºåå­—
```java
@JsonProperty("door_no")
private String doorNo;
```
- å¿½ç•¥å­—æ®µçš„è¾“å‡º
```java
@JsonIgnore
private String doorNo;
```
## ç»“å°¾ã€‚
